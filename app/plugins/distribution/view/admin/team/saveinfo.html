{{:ModuleInclude('public/header')}}

<!-- right content start  -->
<div class="content-right">
    <div class="content">
        <div class="distribution-content">
            <!-- form start -->
            <form class="am-form form-validation am-form-full-screen am-form-popup-fixed" action="{{:PluginsAdminUrl('distribution', 'team', 'save')}}" method="POST" request-type="ajax-reload" request-value="parent">
                <div class="am-form-group">
                    <label>用户信息<span class="am-form-group-label-tips-must">*</span></label>
                    <div class="am-panel am-panel-default am-radius user-info">
                        <div class="am-panel-bd">
                            <input type="number" name="user_id" data-validation-message="请填选择用户" class="am-radius" value="{{if !empty($data['id'])}}{{$data.id}}{{/if}}" required />
                            <img src="{{if empty($data['avatar'])}}{{:UserDefaultAvatar()}}{{else /}}{{$data.avatar}}{{/if}}" class="am-img-thumbnail am-radius am-align-left avatar" width="80" height="80" />
                            <ul class="user-base">
                                <li>
                                    <span>{{:MyLang('user_username_title')}}：</span>
                                    <a href="javascript:;" class="username text-copy-submit">
                                        {{if empty($data['username'])}}<span class="am-text-grey">...</span>{{else /}}{{$data.username}}{{/if}}
                                    </a>
                                </li>
                                <li>
                                    <span>{{:MyLang('user_nickname_title')}}：</span>
                                    <a href="javascript:;" class="nickname text-copy-submit">
                                        {{if empty($data['nickname'])}}<span class="am-text-grey">...</span>{{else /}}{{$data.nickname}}{{/if}}
                                    </a>
                                </li>
                                <li>
                                    <span>{{:MyLang('user_mobile_title')}}：</span>
                                    <a href="javascript:;" class="mobile text-copy-submit">
                                        {{if empty($data['mobile'])}}<span class="am-text-grey">...</span>{{else /}}{{$data.mobile}}{{/if}}
                                    </a>
                                </li>
                                <li>
                                    <span>{{:MyLang('user_email_title')}}：</span>
                                    <a href="javascript:;" class="email text-copy-submit">
                                        {{if empty($data['email'])}}<span class="am-text-grey">...</span>{{else /}}{{$data.email}}{{/if}}
                                    </a>
                                </li>
                            </ul>
                            {{if empty($data['id'])}}
                                <button type="button" class="am-btn am-btn-default am-btn-xs am-radius user-choice-submit">选择用户</button>
                            {{/if}}
                        </div>
                    </div>
                </div>

                <div class="am-form-group am-margin-top-sm">
                    <label class="am-block">分销等级(手动)<span class="am-form-group-label-tips-must">*</span></label>
                    {{if !empty($level_list) and is_array($level_list)}}
                        {{if !empty($data['id'])}}
                            <label class="am-radio-inline">
                                <input type="radio" value="0" name="level_id" data-validation-message="请选择分销等级" data-am-ucheck {{if empty($data['plugins_distribution_level'])}}checked{{/if}} required> 无等级
                            </label>
                        {{/if}}
                        {{foreach $level_list as $k=>$v}}
                            <label class="am-radio-inline">
                                <input type="radio" value="{{$v.id}}" name="level_id" data-validation-message="请选择分销等级" data-am-ucheck {{if isset($data['plugins_distribution_level']) and $data['plugins_distribution_level'] eq $v['id']}}checked{{/if}} required> {{$v.name}}
                            </label>
                        {{/foreach}}
                    {{/if}}
                </div>

                {{if empty($data['id'])}}
                    <!-- 用户搜索容器 -->
                    <div class="user-search-select-container am-radius am-hide"
                        data-url="{{:PluginsAdminUrl('distribution', 'team', 'searchuser')}}"
                        data-search-loading-tips="{{:MyLang('searching_tips')}}" 
                        data-choice-submit-text="{{:MyLang('choice_title')}}" 
                    >
                        <div class="am-padding">
                            <div class="am-input-group am-input-group-sm user-input-search-container">
                                <input type="text" class="am-form-field am-radius" placeholder="用户码/名/昵称/手机/邮箱" />
                                <span class="am-input-group-btn">
                                    <button type="button" class="am-btn am-btn-default am-radius">{{:MyLang('search_title')}}</button>
                                </span>
                            </div>
                        </div>
                        <ul class="am-list am-margin-0 am-scrollable-vertical search-user-list am-hide"></ul>
                        <p class="am-padding-top-xl am-margin-top-xl am-text-grey am-text-center search-tips">请先输入关键字搜索！</p>
                    </div>
                {{/if}}

                <div class="am-form-popup-submit">
                    <button type="button" class="am-btn am-btn-warning am-radius am-btn-xs am-margin-right-lg" data-am-modal-close>
                        <i class="am-icon-paint-brush"></i>
                        <span>{{:MyLang('cancel_title')}}</span>
                    </button>
                    <button type="submit" class="am-btn am-btn-primary am-radius am-btn-xs btn-loading-example" data-am-loading="{spinner: 'circle-o-notch', loadingText:'{{:MyLang('save_title')}}'}">
                        <i class="am-icon-save"></i>
                        <span>{{:MyLang('save_title')}}</span>
                    </button>
                </div>
            </form>
            <!-- form end -->
        </div>
    </div>
</div>
<!-- right content end  -->

<!-- footer start -->
{{:ModuleInclude('public/footer')}}